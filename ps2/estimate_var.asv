[bethat1,~,~,X1] = var_estim(testdata,3)

[test2, ~] = est_var(testdata,3)

Mdl = varm(2,3) 
Estmdl = estimate(Mdl,testdata) 
summarize(Estmdl) 

function [betahat, X] = est_var(y, p)   

    % create regressor matrix
    X = lagmatrix(y,1:p)
    effT = size(y,1) - p
    X = [ones(T,1) X(p+1:end,:)]

    % estimate betahat
    betahat = (y(p+1:end,:).'*X)/(X.'* X) ;


end